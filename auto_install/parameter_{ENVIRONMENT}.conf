#!/bin/bash

# 実行環境に合わせて調整する

# dnfでインストールするパッケージは、インストールするソフトウェアの組み合わせによっては足りないかもしれないので注意
EXEC_USER_NAME=${SUDO_USER:-$USER}
ENVIRONMENT='dev'
ENVIRONMENT_FULL='development'
ROOT_PASSWORD='{rootユーザーのパスワード}'
# マシン依存: Rockyをインストールしたマシンに設定されているデフォルト値に「nomodeset」を追記した内容
# /etc/default/grubを確認する
GRUB_KERNEL_OPTION='"crashkernel=1G-4G:192M,4G-64G:256M,64G-:512M resume=/dev/mapper/rl-swap rd.lvm.lv=rl/root rd.lvm.lv=rl/swap nomodeset"'
# ファイルが存在するか確認する
GRUB_CONFIG_FILE_NAME='/boot/grub2/grub.cfg'
# マシン依存:
# 「nmcli d」を実行して、TYPE列がethernetになっている行のDEVICE列の内容を設定する
NETWORK_DEVICE_NAME='enp0s25'
# マシン依存:
# 「nmcli d」を実行して、TYPE列がethernetになっている行のCONNECTION列の内容を設定する
NETWORK_CONNECTION_NAME='enp0s25'
IPV4_ADDRESS='192.168.10.106/24'
IPV4_GATEWAY='192.168.10.1'
IPV4_DNS='192.168.10.1'
# 半角スペース区切りで、複数指定も可能
IPV4_DNS_LIST=$IPV4_DNS
# 設定する場合は、「sakura.ne.jp」などを指定
IPV4_DNS_SEARCH=''
HOST_NAME='www.dev-kitoku-magic.net'
IS_IPV6_SETTING=1
IPV6_ADDRESS_KEY='ipv6.addresses'
IPV6_ADDRESS_VALUE='{IPv6アドレス}'
# マシン依存:
IPV6_GATEWAY_KEY='ipv6.gateway'
IPV6_GATEWAY_VALUE='{IPv6ゲートウェイ}'
# 設定しない場合は、「ignore」を指定し、その他のIPV6_から始まる項目は全て''にする
IPV6_METHOD_KEY='ipv6.method'
IPV6_METHOD_VALUE='manual'
# マシン依存:
IPV6_DNS_KEY='ipv6.dns'
IPV6_DNS_VALUE='{IPv6DNSサーバーアドレス}'
IPV6_IGNORE_AUTO_DNS_KEY='ipv6.ignore-auto-dns'
IPV6_IGNORE_AUTO_DNS_VALUE='yes'
NET_IPV6_CONF_ALL_DISABLE_IPV6=0
NET_IPV6_CONF_DEFAULT_DISABLE_IPV6=0
# OS依存:
DNF_REMOVE_PACKAGE='openssh openssh-clients openssh-server'
# OS依存:
DNF_ADD_PACKAGE='tar make'
ADD_DNF_REPOSITORY='epel-release'
NTP_SERVER_NAME_LIST=('ntp.nict.jp' 'ntp.jst.mfeed.ad.jp')
CHRONY_ALLOW_NETWORK_ADDRESS='192.168.10.0/24'
GENERAL_USER_NAME='{一般ユーザー名}'
GENERAL_USER_PASSWORD='{一般ユーザーのパスワード}'
CURL_RETRY_OPTION='--retry 60 --retry-delay 10 --retry-max-time 0'
# OS依存:
GCC_VERSION='14.2.0'
# OS依存:
GCC_REQUIRE_PACKAGE='gcc gcc-c++ bzip2'
# OS依存:
ZLIB_VERSION='1.3.1'
# OS依存:
ZLIB_REQUIRE_PACKAGE='glibc-devel'
# OS依存:
OPENSSL_VERSION='3.3.2'
# OS依存:
OPENSSL_REQUIRE_PACKAGE='perl zlib-devel'
# OS依存:
OPENSSH_VERSION='9.9p1'
# OS依存:
OPENSSH_REQUIRE_PACKAGE='libedit-devel pam-devel'
# 自動インストールを実行するサーバーにログインする為の公開鍵の内容（事前に公開鍵と秘密鍵を作成して設定する）
SSH_PUBLIC_KEY='ssh-ed25519 xxx・・・続く'
SSH_PORT={SSHのポート番号}
SSH_SYSLOG_FACILITY='AUTHPRIV'
SSH_LOG_LEVEL='INFO'
SSH_LOGIN_GRACE_TIME=30
SSH_PERMIT_ROOT_LOGIN='no'
SSH_STRICT_MODES='yes'
# テスト時は「0」以外にする
SSH_MAX_AUTHTRIES=3
SSH_MAX_SESSIONS=3
SSH_PUBKEY_AUTHENTICATION='yes'
SSH_AUTHORIZED_KEYS_FILE='.ssh/authorized_keys'
SSH_HOSTBASED_AUTHENTICATION='no'
SSH_IGNORE_USER_KNOWN_HOSTS='no'
SSH_IGNORE_RHOSTS='yes'
SSH_PERMIT_EMPTY_PASSWORDS='no'
SSH_PASSWORD_AUTHENTICATION='no'
SSH_CHALLENGE_RESPONSE_AUTHENTICATION='no'
SSH_USE_PAM='no'
SSH_TCP_KEEP_ALIVE='yes'
SSH_CLIENT_ALIVE_INTERVAL=30
SSH_CLIENT_ALIVE_COUNTMAX=3
SSH_ALLOW_GROUPS='wheel'
SYSTEM_ADMINISTRATOR_MAIL_ADDRESS='{何かあった時に通知したいメールアドレス}'
# vimの最新版が必要な場合は、別途Githubのvimのリポジトリからインストールすること
# OS依存:
VIM_VERSION='9.0'
# OS依存:
VIM_REQUIRE_PACKAGE='libXt-devel gtk3-devel'
# OS依存:
VIM_GUI_TOOL='gtk3'
IS_MYSQL_INSTALL=1
# OS依存:
CMAKE_VERSION='3.30.5'
# OS依存:
MYSQL_MAJOR_VERSION='8.4'
# OS依存:
MYSQL_FULL_VERSION='8.4.2'
# OS依存:
MYSQL_REQUIRE_PACKAGE='gcc-toolset-12-gcc gcc-toolset-12-gcc-c++ gcc-toolset-12-binutils gcc-toolset-12-annobin-annocheck gcc-toolset-12-annobin-plugin-gcc patchelf rpcgen'
MYSQL_PORT=3306
MYSQL_ROOT_PASSWORD='{MySQLのrootユーザーのパスワード}'
# OS依存:
NGINX_VERSION='1.27.2'
DOCUMENT_ROOT='/opt/www'
HTTP_PORT=80
# OS依存:
PHP_VERSION='8.3.12'
# OS依存:
PHPREDIS_VERSION='6.0.2'
# OS依存:
PHP_REQUIRE_PACKAGE='systemd-devel libxml2-devel oniguruma-devel'
# 以下は、特に環境によって変える事
PHP_INI_ZEND_MULTIBYTE='On'
PHP_INI_ZEND_SCRIPT_ENCODING='UTF-8'
PHP_INI_ZEND_EXCEPTION_IGNORE_ARGS='Off'
PHP_INI_EXPOSE_PHP='Off'
PHP_INI_MEMORY_LIMIT='128M'
PHP_INI_ERROR_REPORTING='E_ALL'
PHP_INI_DISPLAY_ERRORS='On'
PHP_INI_DISPLAY_STARTUP_ERRORS='On'
PHP_INI_LOG_ERRORS_MAX_LEN=0
PHP_INI_HTML_ERRORS='On'
PHP_INI_ERROR_LOG='/opt/php/current/log/php.log'
PHP_INI_POST_MAX_SIZE='8M'
PHP_INI_DEFAULT_CHARSET='"UTF-8"'
PHP_INI_UPLOAD_MAX_FILESIZE='2M'
PHP_INI_ALLOW_URL_FOPEN='On'
PHP_INI_ALLOW_URL_INCLUDE='Off'
PHP_INI_DATE_TIMEZONE='Asia/Tokyo'
PHP_INI_MYSQLI_DEFAULT_PORT=$MYSQL_PORT
PHP_INI_MYSQLND_COLLECT_STATISTICS='On'
PHP_INI_MYSQLND_COLLECT_MEMORY_STATISTICS='On'
PHP_INI_SESSION_SAVE_HANDLER='files'
PHP_INI_SESSION_SAVE_PATH='/opt/php/current/session'
PHP_INI_SESSION_USE_STRICT_MODE='On'
PHP_INI_SESSION_USE_COOKIES='On'
PHP_INI_SESSION_COOKIE_SECURE='Off'
PHP_INI_SESSION_USE_ONLY_COOKIES='On'
PHP_INI_SESSION_NAME='php_sess_dev_kitoku_magic_net'
PHP_INI_SESSION_AUTO_START=0
PHP_INI_SESSION_COOKIE_LIFETIME=0
PHP_INI_SESSION_COOKIE_PATH='/'
PHP_INI_SESSION_COOKIE_DOMAIN=''
PHP_INI_SESSION_COOKIE_HTTPONLY='On'
PHP_INI_SESSION_COOKIE_SAMESITE='Strict'
PHP_INI_SESSION_SERIALIZE_HANDLER='php'
PHP_INI_SESSION_GC_PROBABILITY=1
PHP_INI_SESSION_GC_DIVISOR=100
PHP_INI_SESSION_GC_MAXLIFETIME=1440
PHP_INI_SESSION_REFERER_CHECK=''
PHP_INI_SESSION_CACHE_LIMITER='nocache'
PHP_INI_SESSION_CACHE_EXPIRE=180
PHP_INI_SESSION_USE_TRANS_SID='Off'
PHP_INI_SESSION_SID_LENGTH=48
PHP_INI_SESSION_TRANS_SID_TAGS='"a=href,area=href,frame=src,form="'
PHP_INI_SESSION_TRANS_SID_HOSTS='""'
PHP_INI_SESSION_SID_BITS_PER_CHARACTER=6
PHP_INI_SESSION_UPLOAD_PROGRESS_CLEANUP='On'
PHP_INI_SESSION_LAZY_WRITE='On'
PHP_INI_ZEND_ASSERTIONS=1
PHP_INI_ASSERT_ACTIVE='On'
PHP_INI_ASSERT_EXCEPTION='On'
PHP_INI_MBSTRING_LANGUAGE='Japanese'
PHP_INI_MBSTRING_ENCODING_TRANSLATION='Off'
PHP_INI_MBSTRING_DETECT_ORDER='UTF-8,SJIS,EUC-JP,JIS,ASCII'
PHP_INI_MBSTRING_SUBSTITUTE_CHARACTER='none'
PHP_INI_MBSTRING_STRICT_DETECTION='On'
PHP_INI_CURL_CAINFO='/opt/cacert.pem'
PHP_INI_OPENSSL_CAFILE='/opt/cacert.pem'
PHP_INI_OPENSSL_CAPATH=''
PHP_FPM_PM='dynamic'
PHP_FPM_PM_MAX_CHILDREN=5
PHP_FPM_PM_START_SERVERS=2
PHP_FPM_PM_MIN_SPARE_SERVERS=1
PHP_FPM_PM_MAX_SPARE_SERVERS=3
PHP_FPM_PM_PROCESS_IDLE_TIMEOUT='10s;'
PHP_FPM_PM_MAX_REQUESTS=500
IS_PYTHON_INSTALL=1
# OS依存:
PYTHON_VERSION='3.14.0'
# OS依存:
PYTHON_REQUIRE_PACKAGE='bzip2-devel readline-devel libffi-devel openssl-devel'
# OS依存:
REDIS_VERSION='7.2.4'
REDIS_PASSWORD='{redisのパスワード}'
# OS依存:
GIT_VERSION='2.47.0'
# OS依存:
GIT_REQUIRE_PACKAGE='autoconf'
GITHUB_USER_NAME='kitoku-magic'
# 事前に、GitHubの管理画面で作成しておく（最低限、write:public_key権限を付ける）
GITHUB_PERSONAL_ACCESS_TOKEN='{生成したパーソナルアクセストークンの内容}'
GITHUB_SSH_KEY_FILE_NAME='id_ed25519_for_github'
IS_USER_REGISTRATION_FORM_INSTALL=1
# OS依存:
GOOGLE_API_PHP_CLIENT_VERSION='2.18.1'
IS_PRODUCTION_SERVER_ACCESS_SETTING=1
PRODUCTION_SSH_KEY_FILE_NAME='id_ed25519_for_production'
PRODUCTION_HOST_NAME='www.kitoku-magic.net'
PRODUCTION_SSH_PORT=${SSH_PORT}
APPLICATION_BASE_DIRECTORY='/opt/app'
PRODUCTION_RSYNC_BASE_DIRECTORY=${DOCUMENT_ROOT}
GIT_REPOSITORY_DIRECTORY='/opt/git_repository'
IS_LETS_ENCRYPT=1
# OS依存:
CERTBOT_VERSION='2.11.0'
HTTPS_PORT=443
RSA_KEY_SIZE=4096
